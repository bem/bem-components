# popup  

Блок **popup** используется для создания выпадающих элементов и позволяет изменять их состояние, поведение и внешний вид. Блок отображается поверх остальных элементов страницы.

Попап может быть вызван различными элементами страницы, например, иконками или псевдо-ссылками.

В момент показа блок выносит себя в конец `<body>`.



## Модификаторы блока

### Темы блока `_theme`

Блок представлен в следующих темах:

 * simple   
 * normal  

Без указания темы к блоку применяются значения по умолчанию (*default*), установленные браузером. 

Наглядно видно на примерах ниже:

#### default
````bemjson
    {
        block : 'popup', 
        content : 'default' 
    }
````
#### simple

````bemjson
    {
        block : 'popup',
        mods : { theme : 'simple' },
        content : 'simple'
    } 
```` 
#### normal

````bemjson
    {
        block : 'popup',
        mods : { theme : 'normal' },
        content : 'normal'
    }
```` 

### Видимый `_visible`

Модификатор, отвечающий за видимость блока. При значении модификатора `false` блок не отображается. 

Реализован во всех темах:

#### default
````bemjson
    {
        block : 'popup', 
        mods : { visible : true },
        content : 'default'
    }
````
#### simple

````bemjson
    {
        block : 'popup',
        mods : { theme : 'simple', visible : true },
        content : 'simple'
    } 
```` 
#### normal

````bemjson
    {
        block : 'popup',
        mods : { theme : 'normal', visible : true },
        content : 'normal'
    }
```` 


### Выравнивание относительно родителя `_direction`

Модификатор задает направление выравнивания относительно блока, вызвавшего попапа. Выравнивание определяется автаматически, исходя из массива допустимых направлений выравнивания и положения родителя на странице.

Выравнивание влияет на направление анимации раскрытия.

По умолчанию используется следующий массив направлений выравнивания:

<table>
    <tr>
        <th> Направление раскрытия </td>
        <th> Индекс в массиве </td>
    </tr>
        <td> bottom-left </td>
        <td> 0 </td>
    </tr>
    <tr>
        <td> bottom-center </td>
       <td> 1 </td>
   </tr>
    <tr>
        <td> bottom-right</td>
        <td> 2 </td>
    </tr>
    <tr>
        <td> top-left </td>
        <td> 3 </td>
    </tr>
    <tr>
        <td> top-center </td>
        <td> 4 </td>
    </tr>
    <tr>
        <td> top-right </td>
        <td> 5 </td>
    </tr>
    <tr>
        <td> right-top </td>
        <td> 6 </td>    
    </tr>
    <tr>
        <td> right-center </td>
        <td> 7 </td>
    </tr>
    <tr>
        <td> right-bottom </td>
        <td> 8 </td>
    </tr>
    <tr>
        <td> left-top </td>
        <td> 9 </td>
    </tr>
    <tr>
        <td> left-center </td>
        <td> 10 </td>
    </tr>
    <tr>
        <td> left-bottom </td>
        <td> 11 </td>
    </tr>
</table>

Чтобы управлять направлением выравнивания попапа нужно ограничить массив направлений, оставив только нужные. Пользовательский массив направлений нужно передать в качестве JS-параметра с ключом `directions`.

Например, если нужно, чтобы попап раскрывался над родителем:

````bemjson
    {
        block : 'popup',
        mods : { autoclosable : true, theme: 'simple' },
        js : { directions : ['right-top', 'right-center', 'right-bottom'] },
        content : 'Hello, world!'
    }
````

Или разместить попап справа по центру:

````bemjson
    {
        block : 'popup',
        mods : { autoclosable : true, theme: 'simple' },
        js : { directions : ['right-center'] },
        content : 'Hello, world!'
    }
````


### Автоматическое скрытие `_autoclosable`

Модификатор отвечает за автоматическое закрытие попапа при клике вне блока. При значении модификатора `_autoclosable_true` блок будет закрываться при щелчке за его пределами (будет снят модификатор `_visible_true`).

Кроме того, если модификатор установлен, блок будет автоматически закрываться во время скролла. 

Реализован во всех темах:

#### default
````bemjson
    {
        block : 'popup', 
        mods : { autoclosable : true },
        content : 'default'
    }
````
#### simple

````bemjson
    {
        block : 'popup',
        mods : { theme : 'simple', autoclosable : true },
        content : 'simple'
    } 
```` 
#### normal

````bemjson
    {
        block : 'popup',
        mods : { theme : 'normal', autoclosable : true },
        content : 'normal'
    }
````     


##Взаимосвязи между popup'ами

Так как попап выносит себя в конец `<body>`, чтобы перекрывать другие элементы страницы, возникает необходимость в построении взаимосвязей. Блок умеет выстраивать связи Parent → [ Child, Child, ... ]. Для этого он выполняет проверку, вложен ли блок, вызывающий попап в другой `popup`. Потомки знают о наличии родителя. 
Если бы этих взаимосвязей не было, то родительский попап (при наличии модификатора `autoclosable` со значением `true`) закрылся при клике внутри дочернего.

Другими словами, модификатор `autoclosable` со значением `true` означает, что попап закроется сам и закроет свои дочерние блоки при клике за пределами его самого и дочерних попапов. 

Дочерние блоки popup можно рассматривать в виде цепочки 1 → 2 → 3 → 4. При клике на 2-ом попапе – закрываются 3, 4. При клике в 1 – закрываются 2, 3, 4. При клике за пределами любого попапа из цепочки – закроются все.

### Зависимости блока

Блок `popup` зависит от следующего набора блоков:

* i-bem__dom 
* jquery
* dom
* objects
* functions__throttle
